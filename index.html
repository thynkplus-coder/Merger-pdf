<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>PDF Studio ‚Äì Merge, Convert, Compress & More</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="All-in-one PDF tools: merge PDFs, convert JPG to PDF, PDF to JPG, compress PDFs, and basic editing ‚Äì all in your browser." />
  <meta name="robots" content="index,follow" />

  <style>
    :root {
      --bg: #f4f5fb;
      --bg-alt: #e5e7eb;
      --card: #ffffff;
      --text: #0f172a;
      --muted: #6b7280;
      --accent: #111827;
      --accent-soft: #e5e7eb;
      --border: #d4d4d8;
      --danger: #b91c1c;
      --success: #15803d;
      --radius-lg: 18px;
      --radius-pill: 999px;
      --shadow-soft: 0 18px 45px rgba(15, 23, 42, 0.12);
      --transition-fast: 0.18s ease-out;
    }

    body.dark {
      --bg: #020617;
      --bg-alt: #020617;
      --card: #020617;
      --text: #e5e7eb;
      --muted: #9ca3af;
      --accent: #e5e7eb;
      --accent-soft: #111827;
      --border: #1f2937;
      --shadow-soft: 0 18px 45px rgba(0, 0, 0, 0.6);
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      min-height: 100vh;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
      background: radial-gradient(circle at top, var(--bg-alt), var(--bg));
      color: var(--text);
      -webkit-font-smoothing: antialiased;
      transition: background var(--transition-fast), color var(--transition-fast);
    }

    .page {
      max-width: 1040px;
      margin: 0 auto;
      padding: 18px 16px 40px;
    }

    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      margin-bottom: 18px;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .brand-logo {
      width: 34px;
      height: 34px;
      border-radius: 14px;
      background: linear-gradient(135deg, #4f46e5, #06b6d4);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      color: #f9fafb;
      box-shadow: 0 10px 30px rgba(59, 130, 246, 0.4);
    }

    .brand-text-title {
      font-weight: 650;
      letter-spacing: 0.03em;
      font-size: 1.05rem;
    }

    .brand-text-sub {
      font-size: 0.72rem;
      color: var(--muted);
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .pill {
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 0.7rem;
      border: 1px solid var(--border);
      color: var(--muted);
    }

    .theme-toggle {
      border-radius: 999px;
      border: 1px solid var(--border);
      padding: 5px 9px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 0.8rem;
      background: rgba(148, 163, 184, 0.08);
      cursor: pointer;
      outline: none;
      transition: background var(--transition-fast), border var(--transition-fast),
        transform 0.1s ease-out;
    }

    .theme-toggle span.icon {
      font-size: 1rem;
    }

    .theme-toggle:hover {
      transform: translateY(-1px);
      border-color: var(--accent);
    }

    .hero-title {
      font-size: clamp(1.6rem, 3vw, 2rem);
      line-height: 1.15;
      letter-spacing: -0.03em;
      margin: 4px 0 6px;
    }

    .hero-subtitle {
      margin: 0 0 12px;
      color: var(--muted);
      font-size: 0.92rem;
      max-width: 34rem;
    }

    .tool-tabs {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin: 12px 0 14px;
    }

    .tool-tab {
      border-radius: 999px;
      border: 1px solid var(--border);
      padding: 6px 12px;
      font-size: 0.8rem;
      background: rgba(148, 163, 184, 0.05);
      color: var(--muted);
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      transition: background var(--transition-fast), color var(--transition-fast),
        border var(--transition-fast), transform 0.1s ease-out;
    }

    .tool-tab span.icon {
      font-size: 0.9rem;
    }

    .tool-tab.active {
      background: #111827;
      color: #f9fafb;
      border-color: #020617;
    }

    .tool-tab:hover {
      transform: translateY(-1px);
    }

    .layout {
      display: grid;
      grid-template-columns: minmax(0, 1.2fr) minmax(0, 1fr);
      gap: 24px;
      align-items: flex-start;
    }

    @media (max-width: 800px) {
      .layout {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .card {
      background: rgba(15, 23, 42, 0.02);
      backdrop-filter: blur(10px);
      border-radius: var(--radius-lg);
      border: 1px solid rgba(148, 163, 184, 0.25);
      padding: 16px 16px 16px;
      box-shadow: var(--shadow-soft);
    }

    body.dark .card {
      background: radial-gradient(circle at top left, #020617, #020617);
    }

    .tool-panel {
      display: none;
    }

    .tool-panel.active {
      display: block;
    }

    .small-label {
      font-size: 0.78rem;
      font-weight: 500;
      margin-bottom: 6px;
    }

    .upload-box {
      border-radius: 16px;
      border: 1.5px dashed var(--border);
      padding: 12px 10px;
      background: rgba(148, 163, 184, 0.06);
      display: grid;
      gap: 6px;
      margin-bottom: 10px;
    }

    .upload-top {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      flex-wrap: wrap;
    }

    .upload-info {
      font-size: 0.82rem;
      color: var(--muted);
    }

    .file-input {
      position: relative;
      display: inline-flex;
      align-items: center;
    }

    .file-input input[type="file"] {
      position: absolute;
      inset: 0;
      opacity: 0;
      cursor: pointer;
    }

    .file-input-label {
      padding: 7px 12px;
      border-radius: 999px;
      border: 1px solid var(--border);
      font-size: 0.8rem;
      font-weight: 500;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
      background: rgba(15, 23, 42, 0.02);
      transition: background var(--transition-fast), border var(--transition-fast),
        transform 0.1s ease-out;
    }

    .file-input-label:hover {
      transform: translateY(-0.5px);
      border-color: var(--accent);
    }

    .file-hint {
      font-size: 0.78rem;
      color: var(--muted);
    }

    .btn-primary {
      width: 100%;
      margin-top: 8px;
      padding: 9px 14px;
      border-radius: var(--radius-pill);
      border: none;
      font-size: 0.92rem;
      font-weight: 600;
      cursor: pointer;
      background: linear-gradient(135deg, #111827, #020617);
      color: #f9fafb;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      transition: transform 0.08s ease-out, box-shadow var(--transition-fast),
        opacity var(--transition-fast);
      box-shadow: 0 16px 32px rgba(15, 23, 42, 0.45);
    }

    .btn-primary span.icon {
      font-size: 1rem;
    }

    .btn-primary:hover:not(:disabled) {
      transform: translateY(-1.5px);
      box-shadow: 0 20px 50px rgba(15, 23, 42, 0.6);
    }

    .btn-primary:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    .status {
      margin-top: 8px;
      font-size: 0.8rem;
      text-align: left;
      color: var(--muted);
      min-height: 1.2em;
    }

    .status.error {
      color: var(--danger);
    }

    .status.success {
      color: var(--success);
    }

    .side {
      display: grid;
      gap: 12px;
    }

    .sub-card {
      border-radius: var(--radius-lg);
      border: 1px solid rgba(148, 163, 184, 0.35);
      padding: 14px 14px 12px;
      background: rgba(15, 23, 42, 0.02);
    }

    .sub-title {
      font-size: 0.9rem;
      font-weight: 600;
      margin: 0 0 6px;
    }

    .sub-text {
      font-size: 0.8rem;
      color: var(--muted);
      margin: 0 0 8px;
    }

    .sub-list {
      list-style: none;
      padding: 0;
      margin: 0;
      display: grid;
      gap: 4px;
      font-size: 0.78rem;
      color: var(--muted);
    }

    .sub-list li::before {
      content: "‚Äì";
      margin-right: 6px;
      color: var(--accent);
    }

    .preview-img {
      margin-top: 10px;
      max-width: 100%;
      border-radius: 12px;
      border: 1px solid var(--border);
    }

    .inline-inputs {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-top: 4px;
    }

    .inline-inputs input {
      border-radius: 999px;
      border: 1px solid var(--border);
      padding: 6px 10px;
      font-size: 0.8rem;
      background: rgba(15, 23, 42, 0.02);
      color: var(--text);
      min-width: 70px;
    }

    .inline-inputs input:focus {
      outline: none;
      border-color: var(--accent);
    }

    .hint-small {
      font-size: 0.76rem;
      color: var(--muted);
      margin-top: 4px;
    }

    .pill-row {
      margin-top: 10px;
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      font-size: 0.78rem;
    }

    .pill-tag {
      padding: 3px 9px;
      border-radius: 999px;
      background: rgba(148, 163, 184, 0.12);
      border: 1px solid rgba(148, 163, 184, 0.4);
      color: var(--muted);
    }

    .section {
      margin-top: 24px;
      font-size: 0.86rem;
    }

    .section h2 {
      font-size: 0.95rem;
      margin-bottom: 6px;
    }

    .section p,
    .section li {
      color: var(--muted);
      line-height: 1.5;
    }

    .section ul {
      padding-left: 18px;
    }

    .faq-item {
      margin-bottom: 6px;
    }

    .faq-q {
      font-weight: 550;
    }

    footer {
      border-top: 1px solid var(--border);
      margin-top: 24px;
      padding-top: 12px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
      justify-content: space-between;
      font-size: 0.78rem;
      color: var(--muted);
    }

    .footer-links {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .footer-links a {
      color: var(--muted);
      text-decoration: none;
    }

    .footer-links a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
<div class="page">
  <header>
    <div class="brand">
      <div class="brand-logo" aria-hidden="true">P</div>
      <div>
        <div class="brand-text-title">PDF Studio</div>
        <div class="brand-text-sub">Fast, private, in-browser PDF tools</div>
      </div>
    </div>
    <div class="header-right">
      <div class="pill">No signup ¬∑ Free ¬∑ Browser only</div>
      <button id="themeToggle" class="theme-toggle" type="button" aria-label="Toggle dark mode">
        <span class="icon" id="themeIcon">üåô</span>
        <span id="themeText">Dark</span>
      </button>
    </div>
  </header>

  <section>
    <div class="hero-title">All your basic PDF tools in one place.</div>
    <p class="hero-subtitle">
      Merge, convert, compress, and lightly edit PDFs ‚Äî everything runs directly on your device.
      No uploads, no tracking, no watermarks.
    </p>

    <div class="tool-tabs" aria-label="PDF tools">
      <button class="tool-tab active" data-tool="merge"><span class="icon">‚ûï</span>Merge PDF</button>
      <button class="tool-tab" data-tool="jpg2pdf"><span class="icon">üñºÔ∏è</span>JPG to PDF</button>
      <button class="tool-tab" data-tool="pdf2jpg"><span class="icon">üìÑ</span>PDF to JPG</button>
      <button class="tool-tab" data-tool="compress"><span class="icon">üì¶</span>Compress PDF</button>
      <button class="tool-tab" data-tool="edit"><span class="icon">‚úÇÔ∏è</span>Edit (Extract pages)</button>
      <button class="tool-tab" data-tool="security"><span class="icon">üîê</span>Lock / Unlock info</button>
    </div>
  </section>

  <section class="layout">
    <!-- LEFT: MAIN TOOLS -->
    <div class="card">
      <!-- MERGE TOOL -->
      <div class="tool-panel active" data-tool-panel="merge" aria-label="Merge PDF">
        <div class="small-label">Merge multiple PDFs into one file</div>
        <div class="upload-box">
          <div class="upload-top">
            <div class="upload-info">
              Select 2 or more PDF files in the order you want them merged.
            </div>
            <label class="file-input">
              <input id="mergeFiles" type="file" accept="application/pdf" multiple />
              <span class="file-input-label"><span>üìÅ</span><span>Select PDFs</span></span>
            </label>
          </div>
          <div class="file-hint" id="mergeSummary">No files selected yet.</div>
        </div>
        <button id="mergeBtn" class="btn-primary" type="button">
          <span class="icon">‚á©</span><span>Merge & download PDF</span>
        </button>
        <div id="mergeStatus" class="status"></div>
      </div>

      <!-- JPG TO PDF TOOL -->
      <div class="tool-panel" data-tool-panel="jpg2pdf" aria-label="JPG to PDF">
        <div class="small-label">Convert one or more images to a single PDF</div>
        <div class="upload-box">
          <div class="upload-top">
            <div class="upload-info">
              Select JPG or PNG images. They will be added as pages in order.
            </div>
            <label class="file-input">
              <input id="imgFiles" type="file" accept="image/jpeg,image/png,image/webp" multiple />
              <span class="file-input-label"><span>üñºÔ∏è</span><span>Select images</span></span>
            </label>
          </div>
          <div class="file-hint" id="imgSummary">No images selected yet.</div>
        </div>
        <button id="imgToPdfBtn" class="btn-primary" type="button">
          <span class="icon">‚á©</span><span>Convert to PDF</span>
        </button>
        <div id="imgStatus" class="status"></div>
        <div class="hint-small">Note: Large or many images may be slower on mobile devices.</div>
      </div>

      <!-- PDF TO JPG TOOL -->
      <div class="tool-panel" data-tool-panel="pdf2jpg" aria-label="PDF to JPG">
        <div class="small-label">Export first page of a PDF as a JPG image</div>
        <div class="upload-box">
          <div class="upload-top">
            <div class="upload-info">
              Select a single PDF. This tool currently converts the first page to JPG.
            </div>
            <label class="file-input">
              <input id="pdfToJpgFile" type="file" accept="application/pdf" />
              <span class="file-input-label"><span>üìÑ</span><span>Select PDF</span></span>
            </label>
          </div>
          <div class="file-hint" id="pdfToJpgSummary">No PDF selected yet.</div>
        </div>
        <button id="pdfToJpgBtn" class="btn-primary" type="button">
          <span class="icon">‚á©</span><span>Convert first page to JPG</span>
        </button>
        <div id="pdfToJpgStatus" class="status"></div>
        <img id="jpgPreview" class="preview-img" alt="JPG preview" style="display:none;" />
        <div class="hint-small">Full multi-page export is more advanced and not included in this simple demo.</div>
      </div>

      <!-- COMPRESS TOOL -->
      <div class="tool-panel" data-tool-panel="compress" aria-label="Compress PDF">
        <div class="small-label">Try to reduce PDF size (basic re-save)</div>
        <div class="upload-box">
          <div class="upload-top">
            <div class="upload-info">
              Select a single PDF to re-save. This may slightly reduce file size.
            </div>
            <label class="file-input">
              <input id="compressFile" type="file" accept="application/pdf" />
              <span class="file-input-label"><span>üì¶</span><span>Select PDF</span></span>
            </label>
          </div>
          <div class="file-hint" id="compressSummary">No PDF selected yet.</div>
        </div>
        <button id="compressBtn" class="btn-primary" type="button">
          <span class="icon">‚á©</span><span>Compress & download</span>
        </button>
        <div id="compressStatus" class="status"></div>
        <div class="hint-small">
          This is a light, browser-only compressor. For heavy optimization (e.g., reducing images),
          dedicated desktop tools will work better.
        </div>
      </div>

      <!-- EDIT TOOL -->
      <div class="tool-panel" data-tool-panel="edit" aria-label="Edit PDF (extract pages)">
        <div class="small-label">Extract a range of pages into a new PDF</div>
        <div class="upload-box">
          <div class="upload-top">
            <div class="upload-info">
              Select a single PDF, then choose which pages to keep in the new file.
            </div>
            <label class="file-input">
              <input id="editFile" type="file" accept="application/pdf" />
              <span class="file-input-label"><span>‚úÇÔ∏è</span><span>Select PDF</span></span>
            </label>
          </div>
          <div class="file-hint" id="editSummary">No PDF selected yet.</div>
        </div>

        <div class="inline-inputs">
          <input id="editFrom" type="number" min="1" placeholder="From page" />
          <input id="editTo" type="number" min="1" placeholder="To page" />
        </div>
        <div class="hint-small">Example: From 2 to 5 will create a PDF containing pages 2, 3, 4, and 5.</div>

        <button id="editBtn" class="btn-primary" type="button">
          <span class="icon">‚á©</span><span>Extract pages to new PDF</span>
        </button>
        <div id="editStatus" class="status"></div>
      </div>

      <!-- SECURITY INFO TOOL -->
      <div class="tool-panel" data-tool-panel="security" aria-label="PDF security">
        <div class="small-label">About locking & unlocking PDFs</div>
        <p class="hint-small" style="margin-top:4px;">
          Proper PDF password protection and removal involves encryption and decryption. To keep this demo
          simple and safe, this site does <strong>not</strong> try to break or bypass existing passwords.
        </p>
        <ul class="sub-list" style="margin-top:8px;">
          <li><strong>Locking PDFs:</strong> For strong, password-based protection, use a full PDF editor
            (like Adobe Acrobat or other trusted apps) that supports encryption.
          </li>
          <li><strong>Unlocking PDFs:</strong> Only unlock files you own and have the password for.
            Avoid tools that attempt to crack unknown passwords.
          </li>
          <li><strong>What this site does:</strong> All tools here are focused on structure changes
            (merge, convert, extract) and do not alter security or encryption on your documents.
          </li>
        </ul>
        <p class="hint-small">
          This keeps the tools lightweight and avoids risky operations with your sensitive documents.
        </p>
      </div>
    </div>

    <!-- RIGHT: INFO SIDE -->
    <aside class="side">
      <div class="sub-card">
        <h2 class="sub-title">How this site works</h2>
        <p class="sub-text">
          All tools run entirely in your browser using small JavaScript libraries. Your PDFs and images
          are processed in memory and are not sent to any server.
        </p>
        <ul class="sub-list">
          <li>Merge: combine all pages from multiple PDFs into one file.</li>
          <li>JPG ‚Üí PDF: place each image on its own page.</li>
          <li>PDF ‚Üí JPG: render the first page as an image.</li>
          <li>Edit: extract a page range into a fresh PDF.</li>
        </ul>
      </div>

      <div class="sub-card">
        <h2 class="sub-title">Best practices</h2>
        <ul class="sub-list">
          <li>Test with small files first to see results.</li>
          <li>For very large PDFs, a desktop tool may be faster.</li>
          <li>Never upload sensitive documents to websites you don‚Äôt fully trust.</li>
        </ul>
      </div>

      <div class="sub-card">
        <h2 class="sub-title">About this project</h2>
        <p class="sub-text">
          This is a lightweight, educational PDF toolkit designed to show what‚Äôs possible directly
          in the browser, with no backend server.
        </p>
      </div>
    </aside>
  </section>

  <!-- FAQ -->
  <section class="section" id="faq">
    <h2>FAQ</h2>
    <div class="faq-item">
      <div class="faq-q">Do you upload my files?</div>
      <p>No. The tools work using client-side JavaScript. Your PDFs and images stay in your browser‚Äôs memory.</p>
    </div>
    <div class="faq-item">
      <div class="faq-q">Is this suitable for confidential documents?</div>
      <p>
        For highly sensitive data, it is always safest to use offline tools on a device you control.
        This site avoids servers, but you should still follow your own security policies.
      </p>
    </div>
    <div class="faq-item">
      <div class="faq-q">Why does compression sometimes not reduce much?</div>
      <p>
        This demo uses basic re-saving. For heavy compression (aggressive image downscaling and re-encoding),
        use a dedicated PDF compressor app.
      </p>
    </div>
  </section>

  <!-- Privacy -->
  <section class="section" id="privacy">
    <h2>Privacy Policy</h2>
    <p>
      This website is built to avoid storing your documents. All PDF and image processing is done in your browser.
      We do not collect the contents of your files.
    </p>
    <p>
      Your browser or hosting provider may log basic technical information (like IP address, user agent,
      and error logs) when you access the site. We do not use this tool to create user profiles or track
      individual behavior.
    </p>
    <p style="font-size: 0.78rem;">
      If you need strict legal compliance (e.g., for corporate or regulated environments), please consult your
      own legal and security teams before relying on this tool.
    </p>
  </section>

  <!-- Terms -->
  <section class="section" id="terms">
    <h2>Terms of Use</h2>
    <ul>
      <li>This tool is provided ‚Äúas is‚Äù, without any warranties of any kind.</li>
      <li>You are responsible for ensuring you have the right to handle and modify the documents you upload.</li>
      <li>Do not use this website for illegal content or activities.</li>
      <li>We are not liable for data loss, file corruption, or any other damages related to your use of this tool.</li>
    </ul>
  </section>

  <!-- Contact -->
  <section class="section" id="contact">
    <h2>Contact</h2>
    <p>
      You can customize this section with your own contact details, for example:
      <strong>support@example.com</strong> or links to your social profiles.
    </p>
  </section>

  <footer>
    <div>¬© <span id="year"></span> PDF Studio. All rights reserved.</div>
    <div class="footer-links">
      <a href="#faq">FAQ</a>
      <a href="#privacy">Privacy Policy</a>
      <a href="#terms">Terms</a>
      <a href="#contact">Contact</a>
    </div>
  </footer>
</div>

<!-- LIBRARIES -->
<script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>

<script>
  // --- THEME SWITCHER ---
  const body = document.body;
  const themeToggle = document.getElementById("themeToggle");
  const themeIcon = document.getElementById("themeIcon");
  const themeText = document.getElementById("themeText");
  const yearSpan = document.getElementById("year");
  yearSpan.textContent = new Date().getFullYear();

  function applyTheme(theme) {
    if (theme === "dark") {
      body.classList.add("dark");
      themeIcon.textContent = "‚òÄÔ∏è";
      themeText.textContent = "Light";
    } else {
      body.classList.remove("dark");
      themeIcon.textContent = "üåô";
      themeText.textContent = "Dark";
    }
  }

  (function initTheme() {
    const stored = localStorage.getItem("pdfstudio-theme");
    if (stored === "dark" || stored === "light") {
      applyTheme(stored);
    } else {
      const prefersDark = window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;
      applyTheme(prefersDark ? "dark" : "light");
    }
  })();

  themeToggle.addEventListener("click", () => {
    const isDark = body.classList.contains("dark");
    const next = isDark ? "light" : "dark";
    applyTheme(next);
    localStorage.setItem("pdfstudio-theme", next);
  });

  // --- TAB SWITCHING ---
  const tabButtons = document.querySelectorAll(".tool-tab");
  const toolPanels = document.querySelectorAll(".tool-panel");

  tabButtons.forEach((btn) => {
    btn.addEventListener("click", () => {
      const tool = btn.getAttribute("data-tool");
      tabButtons.forEach(b => b.classList.remove("active"));
      toolPanels.forEach(panel => {
        panel.classList.toggle("active", panel.getAttribute("data-tool-panel") === tool);
      });
      btn.classList.add("active");
    });
  });

  // --- PDF-LIB & PDF.JS ---
  const { PDFDocument } = PDFLib;
  if (window["pdfjsLib"]) {
    pdfjsLib.GlobalWorkerOptions.workerSrc =
      "https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js";
  }

  // Utility for statuses
  function setStatus(el, message, type = "") {
    el.textContent = message;
    el.className = "status" + (type ? " " + type : "");
  }

  // --- MERGE TOOL ---
  const mergeFilesInput = document.getElementById("mergeFiles");
  const mergeSummary = document.getElementById("mergeSummary");
  const mergeBtn = document.getElementById("mergeBtn");
  const mergeStatus = document.getElementById("mergeStatus");

  function updateMergeSummary(files) {
    if (!files.length) {
      mergeSummary.textContent = "No files selected yet.";
      return;
    }
    if (files.length === 1) {
      mergeSummary.textContent = "1 file selected: " + files[0].name;
      return;
    }
    const names = Array.from(files).slice(0, 3).map(f => f.name).join(", ");
    const more = files.length > 3 ? " + " + (files.length - 3) + " more" : "";
    mergeSummary.textContent = `${files.length} files selected: ${names}${more}`;
  }

  mergeFilesInput.addEventListener("change", () => {
    updateMergeSummary(mergeFilesInput.files);
    setStatus(mergeStatus, "");
  });

  async function mergePdfs(files) {
    if (!files.length) {
      setStatus(mergeStatus, "Please select at least one PDF file.", "error");
      return;
    }
    if (files.length === 1) {
      setStatus(mergeStatus, "Select 2 or more PDFs to merge.", "error");
      return;
    }

    mergeBtn.disabled = true;
    setStatus(mergeStatus, "Merging PDFs, please wait...");

    try {
      const mergedPdf = await PDFDocument.create();
      for (const file of files) {
        const arrayBuffer = await file.arrayBuffer();
        const pdf = await PDFDocument.load(arrayBuffer);
        const copiedPages = await mergedPdf.copyPages(pdf, pdf.getPageIndices());
        copiedPages.forEach(page => mergedPdf.addPage(page));
      }
      const mergedBytes = await mergedPdf.save();
      const blob = new Blob([mergedBytes], { type: "application/pdf" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "merged.pdf";
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
      setStatus(mergeStatus, "Merged PDF downloaded successfully! üéâ", "success");
    } catch (err) {
      console.error(err);
      setStatus(mergeStatus, "Error while merging PDFs. Try fewer or smaller files.", "error");
    } finally {
      mergeBtn.disabled = false;
    }
  }

  mergeBtn.addEventListener("click", () => {
    mergePdfs(Array.from(mergeFilesInput.files));
  });

  // --- JPG TO PDF ---
  const imgFilesInput = document.getElementById("imgFiles");
  const imgSummary = document.getElementById("imgSummary");
  const imgToPdfBtn = document.getElementById("imgToPdfBtn");
  const imgStatus = document.getElementById("imgStatus");

  function updateImgSummary(files) {
    if (!files.length) {
      imgSummary.textContent = "No images selected yet.";
      return;
    }
    const names = Array.from(files).slice(0, 3).map(f => f.name).join(", ");
    const more = files.length > 3 ? " + " + (files.length - 3) + " more" : "";
    imgSummary.textContent = `${files.length} image(s) selected: ${names}${more}`;
  }

  imgFilesInput.addEventListener("change", () => {
    updateImgSummary(imgFilesInput.files);
    setStatus(imgStatus, "");
  });

  async function imagesToPdf(files) {
    if (!files.length) {
      setStatus(imgStatus, "Please select at least one image.", "error");
      return;
    }

    imgToPdfBtn.disabled = true;
    setStatus(imgStatus, "Building PDF from images...");

    try {
      const pdfDoc = await PDFDocument.create();

      for (const file of files) {
        const bytes = await file.arrayBuffer();
        const type = file.type || "";
        let img;
        if (type.includes("png") || file.name.toLowerCase().endsWith(".png")) {
          img = await pdfDoc.embedPng(bytes);
        } else {
          img = await pdfDoc.embedJpg(bytes);
        }

        const { width, height } = img;
        const maxWidth = 595;   // approx A4 width in points
        const scale = width > maxWidth ? maxWidth / width : 1;
        const pageWidth = width * scale;
        const pageHeight = height * scale;
        const page = pdfDoc.addPage([pageWidth, pageHeight]);
        page.drawImage(img, {
          x: 0,
          y: 0,
          width: pageWidth,
          height: pageHeight,
        });
      }

      const pdfBytes = await pdfDoc.save();
      const blob = new Blob([pdfBytes], { type: "application/pdf" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "images-to-pdf.pdf";
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);

      setStatus(imgStatus, "PDF created from images and downloaded. üéâ", "success");
    } catch (err) {
      console.error(err);
      setStatus(imgStatus, "Error converting images to PDF.", "error");
    } finally {
      imgToPdfBtn.disabled = false;
    }
  }

  imgToPdfBtn.addEventListener("click", () => {
    imagesToPdf(Array.from(imgFilesInput.files));
  });

  // --- PDF TO JPG (FIRST PAGE) ---
  const pdfToJpgFile = document.getElementById("pdfToJpgFile");
  const pdfToJpgSummary = document.getElementById("pdfToJpgSummary");
  const pdfToJpgBtn = document.getElementById("pdfToJpgBtn");
  const pdfToJpgStatus = document.getElementById("pdfToJpgStatus");
  const jpgPreview = document.getElementById("jpgPreview");

  pdfToJpgFile.addEventListener("change", () => {
    if (!pdfToJpgFile.files.length) {
      pdfToJpgSummary.textContent = "No PDF selected yet.";
    } else {
      pdfToJpgSummary.textContent = "Selected: " + pdfToJpgFile.files[0].name;
    }
    setStatus(pdfToJpgStatus, "");
    jpgPreview.style.display = "none";
    jpgPreview.src = "";
  });

  async function pdfFirstPageToJpg(file) {
    if (!file) {
      setStatus(pdfToJpgStatus, "Please select a PDF file.", "error");
      return;
    }
    if (!window["pdfjsLib"]) {
      setStatus(pdfToJpgStatus, "PDF.js library failed to load.", "error");
      return;
    }

    pdfToJpgBtn.disabled = true;
    setStatus(pdfToJpgStatus, "Rendering first page to JPG...");

    try {
      const arrayBuffer = await file.arrayBuffer();
      const loadingTask = pdfjsLib.getDocument({ data: arrayBuffer });
      const pdf = await loadingTask.promise;
      const page = await pdf.getPage(1);

      const viewport = page.getViewport({ scale: 1.5 });
      const canvas = document.createElement("canvas");
      const context = canvas.getContext("2d");
      canvas.width = viewport.width;
      canvas.height = viewport.height;

      const renderContext = {
        canvasContext: context,
        viewport: viewport,
      };
      await page.render(renderContext).promise;

      canvas.toBlob((blob) => {
        if (!blob) {
          setStatus(pdfToJpgStatus, "Failed to create JPG image.", "error");
          pdfToJpgBtn.disabled = false;
          return;
        }
        const url = URL.createObjectURL(blob);

        // Preview
        jpgPreview.src = url;
        jpgPreview.style.display = "block";

        // Download
        const a = document.createElement("a");
        a.href = url;
        a.download = "page-1.jpg";
        document.body.appendChild(a);
        a.click();
        a.remove();

        setStatus(pdfToJpgStatus, "JPG created and downloaded (first page).", "success");
      }, "image/jpeg", 0.92);
    } catch (err) {
      console.error(err);
      setStatus(pdfToJpgStatus, "Error converting PDF to JPG.", "error");
    } finally {
      pdfToJpgBtn.disabled = false;
    }
  }

  pdfToJpgBtn.addEventListener("click", () => {
    const file = pdfToJpgFile.files[0];
    pdfFirstPageToJpg(file);
  });

  // --- COMPRESS (BASIC RESAVE) ---
  const compressFileInput = document.getElementById("compressFile");
  const compressSummary = document.getElementById("compressSummary");
  const compressBtn = document.getElementById("compressBtn");
  const compressStatus = document.getElementById("compressStatus");

  compressFileInput.addEventListener("change", () => {
    if (!compressFileInput.files.length) {
      compressSummary.textContent = "No PDF selected yet.";
    } else {
      compressSummary.textContent = "Selected: " + compressFileInput.files[0].name;
    }
    setStatus(compressStatus, "");
  });

  async function compressPdf(file) {
    if (!file) {
      setStatus(compressStatus, "Please select a PDF file.", "error");
      return;
    }

    compressBtn.disabled = true;
    setStatus(compressStatus, "Re-saving PDF (basic compression)...");

    try {
      const bytes = await file.arrayBuffer();
      const pdf = await PDFDocument.load(bytes);
      const newPdf = await PDFDocument.create();
      const copiedPages = await newPdf.copyPages(pdf, pdf.getPageIndices());
      copiedPages.forEach(p => newPdf.addPage(p));

      const newBytes = await newPdf.save();
      const blob = new Blob([newBytes], { type: "application/pdf" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "compressed.pdf";
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);

      setStatus(compressStatus, "Compressed PDF downloaded (results vary by file).", "success");
    } catch (err) {
      console.error(err);
      setStatus(compressStatus, "Error while compressing PDF.", "error");
    } finally {
      compressBtn.disabled = false;
    }
  }

  compressBtn.addEventListener("click", () => {
    const file = compressFileInput.files[0];
    compressPdf(file);
  });

  // --- EDIT (EXTRACT PAGES) ---
  const editFileInput = document.getElementById("editFile");
  const editSummary = document.getElementById("editSummary");
  const editFrom = document.getElementById("editFrom");
  const editTo = document.getElementById("editTo");
  const editBtn = document.getElementById("editBtn");
  const editStatus = document.getElementById("editStatus");

  editFileInput.addEventListener("change", () => {
    if (!editFileInput.files.length) {
      editSummary.textContent = "No PDF selected yet.";
    } else {
      editSummary.textContent = "Selected: " + editFileInput.files[0].name;
    }
    setStatus(editStatus, "");
  });

  async function extractPages(file, fromPage, toPage) {
    if (!file) {
      setStatus(editStatus, "Please select a PDF file.", "error");
      return;
    }
    if (!fromPage || !toPage || fromPage < 1 || toPage < fromPage) {
      setStatus(editStatus, "Please enter a valid page range.", "error");
      return;
    }

    editBtn.disabled = true;
    setStatus(editStatus, "Extracting pages...");

    try {
      const bytes = await file.arrayBuffer();
      const pdf = await PDFDocument.load(bytes);
      const total = pdf.getPageCount();
      if (fromPage > total) {
        setStatus(editStatus, "From page is beyond total page count (" + total + ").", "error");
        editBtn.disabled = false;
        return;
      }
      const last = Math.min(toPage, total);

      const newPdf = await PDFDocument.create();
      const indices = [];
      for (let i = fromPage - 1; i <= last - 1; i++) {
        indices.push(i);
      }
      const copiedPages = await newPdf.copyPages(pdf, indices);
      copiedPages.forEach(p => newPdf.addPage(p));

      const newBytes = await newPdf.save();
      const blob = new Blob([newBytes], { type: "application/pdf" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = `pages-${fromPage}-to-${last}.pdf`;
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);

      setStatus(editStatus, "New PDF with selected pages downloaded. üéâ", "success");
    } catch (err) {
      console.error(err);
      setStatus(editStatus, "Error extracting pages from PDF.", "error");
    } finally {
      editBtn.disabled = false;
    }
  }

  editBtn.addEventListener("click", () => {
    const file = editFileInput.files[0];
    const from = parseInt(editFrom.value, 10);
    const to = parseInt(editTo.value, 10);
    extractPages(file, from, to);
  });
</script>
</body>
</html>
